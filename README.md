# Лабораторная работа
Смирнов Вячеслав М8О-106БВ-25

## Мини-оболочка с файловыми командами


## Структура проекта

 <pre>
    .
    ├── python-lab-shell                       # Кодовая база лабораторной работы
    │   ├── src/                               # Исходный код
    │   |   ├── commands/                      # Все команды
    │   |   |   ├── __init.py__
    │   |   |   ├── archive_commands.py        # Все операции над архивами
    │   |   |   ├── cat.py                     # Реализация cat
    │   |   |   ├── cd.py                      # Реализация cd
    │   |   |   ├── cp.py                      # Реализация cp
    │   |   |   ├── grep.py                    # Реализация grep
    │   |   |   ├── ls.py                      # Реализация ls
    │   |   |   ├── mv.py                      # Реализация mv
    │   |   |   ├── rm.py                      # Реализация rm
    │   |   ├── __init.py__
    │   |   ├── config.py                      # Конфиг для логгера
    │   |   ├── errors.py                      # Обработка ошибок
    │   |   ├── main.py                        # Главный модуль приложения
    │   |   ├── parser.py                      # Реализация парсера
    │   |   ├── setup_logger.py                # Установка конфига для логгера
    │   ├── tests/                             # Unit тесты
    │   |   ├── __init__.py
    │   |   ├── conftest.py                    # Содержит фикстуру pyfakefs
    │   |   ├── test_archive_commands.py       # Тесты операций над архивами
    │   |   ├── test_cat.py                    # Тесты функции cat
    │   |   ├── test_cd.py                     # Тесты функции cd
    │   |   ├── test_errors.py                 # Тесты обработки ошибок
    │   |   ├── test_grep.py                   # Тесты функции grep
    │   |   ├── test_ls.py                     # Тесты функции ls
    │   |   ├── test_mv.py                     # Тесты функции mv
    │   |   ├── test_parser.py                 # Тесты работы парсера
    │   |   ├── test_rm.py                     # Тесты функции rm
    │   ├── .gitignore                         # git ignore файл
    │   ├──.pre-commit-config.yaml             # Средства автоматизации проверки кодстайла
    │   ├── README.md                          # Описание проекта
    │   ├── pyproject.toml                     # Конфигурация проекта
    │   ├── requirements.txt                   # Зависимости
    │   ├── uv.lock                            # Зависимости
</pre>

## Алгоритм
1. Строка, введеная пользователем передается в parser.py
2. parser.parse_command() разбивает строку на команду и аргументы
3. Вызывается соответствующая функция
4. Проверяются права доступа, наличие файлов и пути, в случае ошибки вызывается соответствующая функция из errors.py
5. Все операции сохраняются в журнал shell.log через setup_logger.py

## Команды
* `ls <path>` - вывод содержимого каталога (флаг -l для подробной информации)
* `cd <path>` - смена текущей директории
* `cat <file>` - вывод содержимого файла
* `cp <source> <dest>` - копирование файлов и каталогов (флаг -r для каталогов)
* `mv <source> <dest>` - перемещение/переименование файлов и каталогов
* `rm <path>` - удаление каталога/файла (фла -r для каталогов)
* `grep <pattern> <path>` - поиск строк по шаблону (флаги -r для рекурсии, -i для неучитывания регистра)
* `zip <folder> <archive.zip>` - архивация каталога в ZIP
* `unzip <archive.zip>` - распаковка ZIP-архива в текущий рабочий каталог
* `tar <folder> <archive.tar.gz>` - архивация каталога в TAR.GZ
* `untar <archive.tar.gz>` - распаковка TAR.GZ-архива в текущий рабочий каталог

## Тестирование
* Все команды покрыты юнит-тестами с использованием pytest и pyfakefs
* Запуск тестов: `pytest -v`
* Проверка покрытия тестов: `pytest -v --cov=src`

## Логирование
* Логи хранятся в файле shell.log и включают:
    * дату, время
    * выполненную команду

## Допущения
* Все пути передаются как строки, поддерживаются относительные и абсолютные пути.
* При копировании или удалении каталога требуется флаг -r.
* Команды zip и tar создают архивы только из существующих директорий.
* Распаковка unzip и untar выполяется в текущий каталог
* grep не ищет текст в бинарных файлах
* Логирование включено по умолчанию и не требует дополнительной настройки
